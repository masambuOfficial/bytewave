# Laravel cPanel Deployment Commands
# Run these commands in cPanel Terminal after uploading files

# 1. Navigate to your Laravel project
cd /home/username/public_html
# Replace 'username' with your actual cPanel username

# 2. Install dependencies (production only)
composer install --no-dev --optimize-autoloader

# 3. Copy environment file and configure
cp .env.example .env
nano .env
# Edit: APP_URL, DB settings, MAIL settings
# Press CTRL+X, then Y, then ENTER to save

# 4. Generate application key
php artisan key:generate

# 5. IMPORTANT: Remove old storage symlink and create new one
rm -rf public/storage
php artisan storage:link
# Verify: ls -la public/storage

# 6. Set proper permissions (CRITICAL FOR IMAGES)
chmod -R 775 storage
chmod -R 775 bootstrap/cache
chmod -R 775 storage/app/public
chmod 644 .env

# 7. Clear all caches first
php artisan config:clear
php artisan cache:clear
php artisan view:clear
php artisan route:clear

# 8. Cache configuration for production
php artisan config:cache
php artisan route:cache
php artisan view:cache

# 9. Run database migrations (if needed)
php artisan migrate --force

# 10. Seed database (if needed)
php artisan db:seed --force

# 11. Verify storage symlink
readlink public/storage
# Should show: /home/username/public_html/storage/app/public

# 12. Test image access in browser
# Visit: https://yourdomain.com/storage/services/test.jpg

# TROUBLESHOOTING:
# If images still don't load:
# - Check: ls -la storage/app/public/
# - Check: ls -la public/storage
# - Verify APP_URL in .env matches your domain
# - Clear browser cache
